<ion-app>
  <ion-header class="ion-no-border">
    <ion-toolbar
      color="primary"
      style="border-bottom-left-radius: 15px; border-bottom-right-radius: 15px"
    >
      <ion-buttons slot="start">
        <ion-back-button defaultHref="AvisnonExpert"></ion-back-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-item>
    <ion-avatar slot="start">
      <img src="{{ ConsultationMedService.consultation_id.url }}" />
    </ion-avatar>
    <ion-label>
      <p>Patient,</p>
      <h3>{{ patient?.username }}</h3>
    </ion-label>
    <ion-icon class="calendar" name="calendar-outline" color="gris"></ion-icon>
    <h4>{{ consultation?.dateConsult }}</h4>
  </ion-item>
  <!-- si je confirme pour l'avis d'un expert un ion-progress bar is here -->

  <ion-list class="details">
    <!-- <div class="header"> -->
    <ion-item color="couleurbase" class="item1">
      <ion-icon name="transgender" color="primary"></ion-icon>
      <h3>{{ patient?.gender }}</h3></ion-item
    >

    <ion-item color="couleurbase">
      <ion-icon name="call" color="primary"></ion-icon>

      <h3>{{ patient?.telephone }}</h3>
    </ion-item>

    <ion-item color="couleurbase">
      <ion-icon name="calendar-outline" color="primary"></ion-icon>
      <h3>{{ patient?.dateNaiss }}</h3></ion-item
    >

    <ion-item lines="none" color="couleurbase" class="item4">
      <ion-icon name="medkit" color="primary"></ion-icon>
      <h3>{{ patient?.antecedant }}</h3>
    </ion-item></ion-list
  >

  <div class="segment">
    <ion-segment
      mode="ios"
      [(ngModel)]="segment"
      color="primary"
      (ionChange)="segmentChanged($event)"
    >
      <ion-segment-button
        value="droite"
        [disabled]="
          consultation?.autoDetection?.avisExpert?.maladieDroite === null
        "
        ><ion-icon name="eye-outline" color="favorites"></ion-icon
        ><ion-text color="favorites"> Oeil Droite</ion-text>
      </ion-segment-button>
      <ion-segment-button
        value="gauche"
        (click)="what()"
        [disabled]="
          consultation?.autoDetection?.avisExpert?.maladieGauche === null
        "
      >
        <ion-icon name="eye-outline" color="favorites"></ion-icon>
        <ion-text color="favorites"> Oeil Gauche</ion-text></ion-segment-button
      >
    </ion-segment>
  </div>

  <ion-content>
    <div class="segment"></div>

    <div *ngIf="consultation?.demandeAvisD !== 0">
      <ion-card class="cardfull">
        <swiper
          [config]="config"
          class="swiper-slide"
          data-swiper-autoplay="2000"
        >
          <ng-template swiperSlide *ngFor="let imge of images; let i = index">
            <img
              [src]="imge"
              onerror="this.src='assets/add.jpg'"
              alt="alternative"
              tappable
              (click)="openPreview(imge)"
            />
          </ng-template>
        </swiper>
      </ion-card>
      <div class="details">
        <h4>AI Résultat Oeil Droite</h4>

        <h6>
          <ion-text color="danger">Maladie : </ion-text>
          diabète
        </h6>
        <ion-text color="danger">Gravitè :</ion-text>
        1
      </div>
      <ion-button
        *ngIf="
          consultation?.demandeAvisD !== 0 &&
          consultation?.autoDetection?.avisExpert?.maladieDroite === null
        "
        color="danger"
        expand="block"
        size="large"
        shape="round"
        class="AvisExpert"
        (click)="DemanderAvis()"
        disabled="true"
        >Demande Avis envoyé</ion-button
      >
      <div
        class="avis ion-margin ion-padding"
        *ngIf="consultation?.autoDetection?.avisExpert?.maladieDroite !== null"
      >
        <ion-item lines="none" color="aviscolor">
          <div>
            <ion-label class="avisExpert ion-margin"> Avis Expert :</ion-label>
          </div>

          <!-- modification bsh yaaml api update yrjaali l hajet l khtrtha  -->
        </ion-item>

        <div class="text">
          <div class="ion-margin">
            <ion-label class="oeil">Maladie :</ion-label
            ><ion-text class="ion-margin"
              >{{ consultation?.autoDetection?.avisExpert?.maladieDroite }}
            </ion-text>
          </div>
          <div class="ion-margin">
            <ion-label class="oeil">Gravité :</ion-label
            ><ion-text class="ion-margin"
              >{{ consultation?.autoDetection?.avisExpert?.graviteDroite }}
            </ion-text>
          </div>

          <div class="ion-margin">
            <ion-label class="oeil">Commentaire :</ion-label
            ><ion-text class="ion-margin"
              >{{ consultation?.autoDetection?.avisExpert?.commentaireDroite }}
            </ion-text>
          </div>
        </div>
      </div>
    </div>
    <ng-container [ngSwitch]="segment"
      ><app-consultation-avis-gauche
        *ngSwitchCase="'gauche'"
      ></app-consultation-avis-gauche>
    </ng-container>
  </ion-content>
</ion-app>
